
# open api spec
[Swagger/OpenAPI 的 ASP.NET Core Web API 文件](https://learn.microsoft.com/zh-tw/aspnet/core/tutorials/web-api-help-pages-using-swagger?view=aspnetcore-8.0&preserve-view=true)


Swagger 專案於 2015 年已捐贈給 OpenAPI 方案，此後一直將其稱為 OpenAPI。 這兩個名稱會交替使用。 不過，「OpenAPI」是指規格。 「Swagger」是指 SmartBear 中與 OpenAPI 規格搭配使用的開放原始碼和商業產品系列。 後續的開放原始碼產品 (如 OpenAPIGenerator) 儘管不是由 SmartBear 發佈，但也屬於 Swagger 系列名稱。

簡言之：

OpenAPI 是規格。
Swagger 是使用 OpenAPI 規格的工具。 例如，OpenAPIGenerator 和 SwaggerUI。

[保哥文章：如何在 ASP․NET Core 3 完整設定 NSwag 與 OpenAPI v3 文件](https://blog.miniasp.com/post/2019/12/21/ASP%E2%80%A4NET-Core-3-NSwag-OpenAPI-v3#google_vignetteW)






# 啟用 web api 分析器
在專案設定黨加入，IncludeOpenAPIAnalyzers 屬性

```xml
<IncludeOpenAPIAnalyzers>true</IncludeOpenAPIAnalyzers>
```

# 示範使用


# open api 工具
```sh
dotnet tool install -g Microsoft.dotnet-openapi
```

```sh
dotnet openapi add url  https://ws-community-t.houseprice.tw/swagger/v2/swagger.json --output-file CommunityWs.json
dotnet openapi add url https://ws-community-t.houseprice.tw/swagger/v2/swagger.json  
dotnet openapi add url https://ws-community-t.houseprice.tw/swagger/v2/swagger.json
dotnet openapi refresh url https://ws-community-t.houseprice.tw/swagger/v2/swagger.json

```

```xml
  <ItemGroup>
    <OpenApiReference Include="CommunityWs.json" SourceUrl="https://ws-community-t.houseprice.tw/swagger/v2/swagger.json" >
    </OpenApiReference>
  </ItemGroup>

<!-- visual studio 產出來的版本 -->

    <ItemGroup>
    <OpenApiReference Include="OpenAPIs\swagger.json" CodeGenerator="NSwagCSharp" ClassName="CommunityWS">
      <SourceUri>https://ws-community-t.houseprice.tw/swagger/v2/swagger.json</SourceUri>
    </OpenApiReference>
  </ItemGroup>
```


```C#
  services.AddScoped(sp =>
  {
      var hcf = sp.GetRequiredService<IHttpClientFactory>();
      var client = hcf.CreateClient();
      var option = sp.GetRequiredService<IOptions<WebUrlOptions>>();

      return new CommunityWS(option.Value.HousePriceWsCommunityLoc, client);
  });
```
